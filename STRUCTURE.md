# Post-Migration File Structure

After completing the migration steps in MIGRATION_GUIDE.md, your monorepo will look like:

```
pandcj4/
├── .git/                          (git repository)
├── .gitignore                     (new - ignores node_modules, dist, .env)
├── package.json                   (updated - monorepo config with workspaces)
├── pnpm-lock.yaml                (deleted - will be regenerated after pnpm install)
├── 
├── frontend/
│   ├── node_modules/             (generated by pnpm install)
│   ├── dist/                      (generated by pnpm build - static files)
│   ├── src/                       (copy from root src/)
│   │   ├── main.tsx
│   │   ├── env.d.ts
│   │   ├── app/
│   │   ├── assets/
│   │   ├── imports/
│   │   ├── services/
│   │   └── styles/
│   ├── index.html                 (new - entry point)
│   ├── package.json               (new - frontend dependencies)
│   ├── vite.config.ts             (new - moved from root)
│   ├── postcss.config.mjs         (new - moved from root)
│   ├── tsconfig.json              (new)
│   ├── tsconfig.node.json         (new)
│   ├── .env                       (create if needed)
│   └── .env.example               (create manually)
│
├── backend/
│   ├── node_modules/              (generated by pnpm install)
│   ├── index.js                   (updated - now serves static frontend)
│   ├── seed.js
│   ├── models/
│   ├── routes/
│   ├── package.json               (updated - added build script)
│   ├── .env                       (existing - keep MongoDB URI)
│   └── pnpm-lock.yaml
│
├── MONOREPO_SETUP.md              (new - full documentation)
├── MIGRATION_GUIDE.md             (new - step-by-step migration)
├── STRUCTURE.md                   (this file)
├── README.md                      (update to reference monorepo)
├── ENV_SETUP.md
├── ATTRIBUTIONS.md
└── (other root files)
```

## What You Need To Do

1. **Copy source files** (Optional, can be done manually):
   ```powershell
   Copy-Item -Path "src\*" -Destination "frontend\src" -Recurse -Force
   ```

2. **Remove old files from root** (Optional):
   ```powershell
   Remove-Item -Path "src" -Recurse -Force
   Remove-Item -Path "index.html" -Force
   Remove-Item -Path "vite.config.ts" -Force
   Remove-Item -Path "postcss.config.mjs" -Force
   ```

3. **Install dependencies**:
   ```powershell
   pnpm install
   ```

4. **Test setup**:
   ```powershell
   pnpm dev            # Run both frontend and backend
   # OR
   pnpm dev:frontend   # Just frontend (port 5173)
   pnpm dev:backend    # Just backend (port 5000)
   ```

## How The Monorepo Works After Migration

### Development
- `pnpm dev` starts both Vite dev server (frontend) and Express server (backend)
- Frontend modifies at `http://localhost:5173` (with hot reload)
- Backend API runs at `http://localhost:5000`
- CORS is enabled so frontend can call backend

### Production Build
```bash
pnpm build
```
- Frontend builds to `frontend/dist/` as static files
- Express backend serves these static files
- API routes still work at `/api/*`
- Non-API routes serve `index.html` for client-side routing

### Production Server
```bash
pnpm start
```
- Express server runs on port 5000 (configurable via PORT env var)
- Serves compiled frontend from `frontend/dist/`
- Database connectivity checked on API requests
- **When content updates, users must refresh the browser** (no hot updates in production)

## Notes

- The `.env` file is excluded from git (in `.gitignore`)
- Frontend dependencies are separate from backend
- Build is a two-step process: frontend build outputs to dist/, backend serves it
- Express handles both static file serving AND API routing
